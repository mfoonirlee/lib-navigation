!function(a,b){function c(a){a=a||"";var b=this,c={};if(a&&"string"==typeof a)for(var d=a.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");c[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}else if("object"==typeof a)for(var g in a)c[g]=a[g];for(var g in c)!function(a){Object.defineProperty(b,a,{get:function(){return c[a]},set:function(b){c[a]=b},enumerable:!0})}(g);this.toString=function(){return Object.keys(c).sort().map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(c[a])}).join("&")}}function d(){function b(a){var b=e.createElement("a");b.href=a;var c=e.createEvent("HTMLEvents");c.initEvent("click",!1,!0),b.dispatchEvent(c)}function d(a,b){var c=e.createEvent("HTMLEvents");if(c.initEvent(a,!1,!1),b)for(var d in b)c[d]=b[d];window.dispatchEvent(c)}function i(){this.exec=function(){d("navigation:push")}}function j(){this.exec=function(){d("navigation:pop")}}function k(){this.exec=function(){d("navigation:replace")}}function l(a,b){return a.name===b.name&&a.args.toString()===b.args.toString()}var m=this,n=[],o=!1,p=!!g.state,q={},r="initial";n.ensureStart=function(){o||(o=!0,h(function(){n.length&&n.shift().exec(),h(arguments.callee)}))},this.push=function(a,e){var f={name:a,args:new c(e),id:q.state.id+1};if(!l(f,q.state)){r="push";var h=f.args.toString();if(p){var i="#"+f.name+(h?"?"+h:"");g.pushState({name:f.name,args:h,id:f.id},null,i),d("pushstate")}else{var i="#"+f.name+"["+f.id+"]"+(h?"?"+h:"");b(i)}}},this.pop=function(){q.state.id>1&&(r="pop",g.back())},this.replace=function(a,e){var f={name:a,args:new c(e),id:q.state.id};if(!l(f,q.state)){r="replace";var h=f.args.toString();if(p){var i="#"+f.name+(h?"?"+h:"");g.replaceState({name:f.name,args:h,id:f.id},null,i),d("replacestate")}else{var i="#"+f.name+"["+f.id+"]"+(h?"?"+h:"");b(i)}}};var s=!1;this.start=function(b){function d(){var a;if(p&&null!=g.state&&g.state!==!0)a={id:g.state.id,name:g.state.name,args:new c(g.state.args)};else{var b=f.hash,d=b.match(/#([^\[\]\?]+)(?:\[(\d+)\])?(?:\?(.*))?/)||["",h,1,l];a={name:d[1],id:parseInt(d[2]||1),args:new c(d[3]||"")}}return a}function e(){var a=d(),b=q.state;q.state=a,a.id<b.id?(r="pop",n.push(new j(a,a.id-b.id))):a.id===b.id?"replace"===m.action?n.push(new k(a)):console.error("请勿用location.hash或location.href来改变hash值"):(r="push",n.push(new i(a,a.id-b.id)))}if(!s){s=!0;var h=b.defaultPath||"",l=b.defaultArgs||"";p&=!!b.useHistoryState,Object.defineProperty(this,"useHistoryState",{get:function(){return p}}),Object.defineProperty(this,"action",{get:function(){return r}}),Object.defineProperty(this,"state",{get:function(){return{id:q.state.id,name:q.state.name,args:q.state.args}}});var o=d();p?(a.addEventListener("pushstate",e,!1),a.addEventListener("popstate",e,!1),a.addEventListener("replacestate",e,!1)):a.addEventListener("hashchange",e,!1),q.state=o,n.push(new i(o)),n.ensureStart()}}}var e=a.document,f=a.location,g=a.history;!g.state&&g.replaceState&&g.replaceState(!0);var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(a){setTimeout(a,1/60)};b.navigation=d}(window,window.lib||(window.lib={}));